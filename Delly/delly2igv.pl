#!/usr/bin/perl
use strict;
use warnings;

use feature qw/ say /;

my $file = $ARGV[0];

open my $in, '<', $file or die $!;

my ($name, $extention) = split(/\.([^.]+)$/, $file, 2);

open my $out, '>', $name . ".filt." . $extention or die $!;


while(<$in>){
	chomp;
	if (/^#/){
		print $out "$_\n";
		next;
	}

        my ($filter, $info, $format, $tumour, $normal) = (split)[6..10];

        next unless $filter eq 'PASS';
       
        my @tumour_parts = split(/:/, $tumour);
        my @normal_parts = split(/:/, $normal);	
 
       # my ($GT, $GL, $GQ, $FT, $RCL, $RC, $RCR, $CN, $DR, $DV, $RR, $RV) = split(/:/, $tumour)
        
        next unless $normal_parts[0] eq '0/0'; # filter out if control is NOT homozygous reference
         
	if ((split)[3] =~ /[ATGC]/){
		print $out "$_\n";
	}
	
}


__DATA__
##contig=<ID=211000022280686,length=2922>
##contig=<ID=211000022280742,length=12513>
##contig=<ID=211000022280748,length=5564>
##contig=<ID=211000022280763,length=12001>
##contig=<ID=mitochondrion_genome,length=19524>
##bcftools_concatVersion=1.3.1+htslib-1.3.1
##bcftools_concatCommand=concat -a -O v -o HUM-1.TEx.nodups.svs.vcf HUM-1.TEx.nodups.DELS.bcf HUM-1.TEx.nodups.DUPS.bcf HUM-1.TEx.nodups.INV.bcf HUM-1.TEx.nodups.TRA.bcf
#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  HUM-1   HUM-3
2L      8888    DEL00000000     G       <DEL>   0       PASS    IMPRECISE;SVTYPE=DEL;SVMETHOD=EMBL.DELLYv0.7.6;CHR2=2L;END=9483;PE=3;MAPQ=60;CT=3to5;CIPOS=-200,200;CIEND=-200,200      GT:GL:GQ:FT:RCL:RC:RCR:CN:DR:DV:RR:RV   0/1:-3.89279,0,-33.8928:39:PASS:45:62:22:2:6:1:0:0      0/1:-4.47426,0,-130.474:45:PASS:85:144:46:2:23:2:0:0
2L      12963   DUP00000000     T       <DUP>   0       PASS    PRECISE;SVTYPE=DUP;SVMETHOD=EMBL.DELLYv0.7.6;CHR2=2L;END=13201;PE=2;MAPQ=48;CT=5to3;CIPOS=-7,7;CIEND=-7,7;INSLEN=0;HOMLEN=7;SR=10;SRQ=1;CONSENSUS=AGTAAATGAAACGAAATCAATATCAATAAAATATATTGTCAAACCAGAGTAAATGCAAAAGCACTTTTAACACTTATACATATACAGAACACCAAAAGAATAGACGCTACAGTCGAGTTACCCATTACAGAAATAGTAGGAGGATAGGTGAAATTTTAAAAACAAAATTT;CE=1.80621 GT:GL:GQ:FT:RCL:RC:RCR:CN:DR:DV:RR:RV   0/0:0,-2.70847,-33.1992:27:PASS:16:51:7:4:5:0:9:0       0/1:-18.768,0,-83.6658:10000:PASS:30:116:29:4:20:2:26:8
2L      18893   DEL00000001     A       <DEL>   .       PASS    IMPRECISE;SVTYPE=DEL;SVMETHOD=EMBL.DELLYv0.7.6;CHR2=2L;END=21701;PE=4;MAPQ=29;CT=3to5;CIPOS=-96,96;CIEND=-96,96 GT:GL:GQ:FT:RCL:RC:RCR:CN:DR:DV:RR:RV   0/1:-1.28661,0,-62.0893:13:LowQual:126:288:163:2:11:2:0:0       0/1:-1.97543,0,-114.477:20:PASS:332:714:402:2:22:3:0:0
2L      25372   DUP00000001     A       <DUP>   .       PASS    IMPRECISE;SVTYPE=DUP;SVMETHOD=EMBL.DELLYv0.7.6;CHR2=2L;END=25768;PE=6;MAPQ=59;CT=5to3;CIPOS=-189,189;CIEND=-189,189     GT:GL:GQ:FT:RCL:RC:RCR:CN:DR:DV:RR:RV   0/0:0,-2.10699,-39.2998:21:PASS:28:77:27:3:7:0:0:0      0/1:-21.1712,0,-123.093:10000:PASS:58:225:66:4:22:6:0:0
2L      47507   DEL00000002     C       <DEL>   .       PASS    PRECISE;SVTYPE=DEL;SVMETHOD=EMBL.DELLYv0.7.6;CHR2=2L;END=52560;PE=32;MAPQ=60;CT=3to5;CIPOS=-14,14;CIEND=-14,14;INSLEN=0;HOMLEN=14;SR=10;SRQ=0.992647;CONSENSUS=GATGGTAAAAGGAAATCAGTAAAAGCTGCATCAATAGCAACAAATATGCACGAAAAACGAACACATATTGAAAAGCGAAAACAGGAGAAGCAATAAAGTGGCATTTTAACAGCATCTGGTGAATGGTTAGCGATGG;CE=1.8579       GT:GL:GQ:FT:RCL:RC:RCR:CN:DR:DV:RR:RV   1/1:-54.2984,-4.51383,0:45:PASS:345:0:308:0:1:12:0:15   1/1:-76.1977,-6.31935,0:63:PASS:771:0:741:0:3:22:0:21
2L      53504   DEL00000003     A       <DEL>   .       LowQual IMPRECISE;SVTYPE=DEL;SVMETHOD=EMBL.DELLYv0.7.6;CHR2=2L;END=53872;PE=2;MAPQ=60;CT=3to5;CIPOS=-76,76;CIEND=-76,76 GT:GL:GQ:FT:RCL:RC:RCR:CN:DR:DV:RR:RV   0/0:0,-3.31133,-66:33:PASS:30:42:28:1:11:0:0:0  0/1:-10.4743,0,-124.474:105:PASS:82:107:43:2:22:3:0:0
2L      73103   DEL00000004     T       <DEL>   .       LowQual IMPRECISE;SVTYPE=DEL;SVMETHOD=EMBL.DELLYv0.7.6;CHR2=2L;END=73614;PE=2;MAPQ=60;CT=3to5;CIPOS=-225,225;CIEND=-225,225     GT:GL:GQ:FT:RCL:RC:RCR:CN:DR:DV:RR:RV   0/0:0,-3.61235,-72:36:PASS:44:71:30:2:12:0:0:0  0/1:-5.37735,0,-113.377:54:PASS:78:136:51:2:20:2:0:0
2L      75754   DEL00000005     C       <DEL>   .       LowQual IMPRECISE;SVTYPE=DEL;SVMETHOD=EMBL.DELLYv0.7.6;CHR2=2L;END=76249;PE=2;MAPQ=60;CT=3to5;CIPOS=-50,50;CIEND=-50,50 GT:GL:GQ:FT:RCL:RC:RCR:CN:DR:DV:RR:RV   0/1:-2.9897,0,-50.9897:30:PASS:21:51:38:2:9:1:0:0       0/0:0,-4.83706,-204:48:PASS:74:166:79:2:35:1:0:0
2L      78079   DEL00000006     .       <DEL>   .       LowQual IMPRECISE;SVTYPE=DEL;SVMETHOD=
